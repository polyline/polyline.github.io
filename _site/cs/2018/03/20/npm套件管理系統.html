<p><em>此文章尚未校正</em></p>

<hr />
<h2 id="前言">前言</h2>
<hr />

<p>由於我最近在學習<em>React.js</em>跟<em>node.js</em>，於是開始接觸到<em>npm</em>這個詞</p>

<p>常常有時候在安裝軟體時，也會看到這行指令</p>

<p>但總是沒有認真地去理解，為什麼要用npm？</p>

<p>所以今天好好的整理一篇文章來學習npm到底是什麼</p>

<hr />
<h2 id="npm是什麼為什麼要知道它">npm是什麼？為什麼要知道它？</h2>
<hr />

<p><code class="highlighter-rouge">npm</code>是一個套件管理系統，用來管理專案下使用的套件，並且可以讓JavaScript工程師們分享和使用彼此的套件</p>

<p>有了<code class="highlighter-rouge">npm</code>之後，我們管理跟使用套件變得很容易</p>

<p>只要下簡單的指令，就能夠在npm server上分享或者使用套件</p>

<p>專案下的套件(packages)會放在<code class="highlighter-rouge">node_modules</code>的資料夾下</p>

<p>此外，也能夠自訂自己的套件，並且在<em>package.json</em>檔案中，提供基本訊息像是：作者、版本號、名稱等等</p>

<hr />
<h2 id="npm常用指令">npm常用指令</h2>
<hr />

<p>查詢npm命令列表</p>

<div class="highlighter-rouge"><pre class="highlight"><code>npm help
</code></pre>
</div>

<p>查詢各個命令的基本用法</p>

<div class="highlighter-rouge"><pre class="highlight"><code>npm -l
</code></pre>
</div>

<p>初始化一個新的<em>package.json</em>文件</p>

<div class="highlighter-rouge"><pre class="highlight"><code>npm init
</code></pre>
</div>

<p>查詢每個package的基本資料</p>

<div class="highlighter-rouge"><pre class="highlight"><code>npm info {package-name}
</code></pre>
</div>

<p>找出放全局包(glocal packaged)的路徑</p>

<div class="highlighter-rouge"><pre class="highlight"><code>npm root -g
</code></pre>
</div>

<p>列出當前專案所有的packages</p>

<div class="highlighter-rouge"><pre class="highlight"><code>npm list 
npm list -global
</code></pre>
</div>

<p>安裝package「到目前專案」，注意，npm預設本地模式，也就是每次不同專案，都必須重新安裝要用到的packages</p>

<div class="highlighter-rouge"><pre class="highlight"><code>npm install {package-name}
npm install -g {package-name} # global mode
</code></pre>
</div>

<p>也能直接用<em>Github</em>代碼庫地址</p>

<div class="highlighter-rouge"><pre class="highlight"><code>npm install {http://github.com/~}
</code></pre>
</div>

<p>dependencies(依賴)，也就是專案中會用到的其他工具包列表，分為兩種：dependencies(依賴)跟devDependencies(開發依賴)</p>

<p>dependencies下的package指的是，別人如果要使用現在這個package，也必須安裝的pacakges，就像是堆積木一樣</p>

<p>現在這個package是基於dependencies下其他的packages所構成的，所以當要使用現在這個package，就要先連下面的packages都安裝好</p>

<p>而devDependencies(開發依賴)指的是只有在開發環境下用到的別的packages，意味著別人使用這個package，並不需要安裝</p>

<p>舉例來說，假設你今天買了一台iphone，如果要順利使用iphone，手機裡面那些零件是必備的，所以也要包含在iphone中</p>

<p>但是假設Apple說測試過iphone被車子碾過也不會壞掉</p>

<p>你要順利使用iphone，不用那台車子也可以順利使用，這是因為車子是用來開發時測試的</p>

<hr />

<p>我們安裝packages時，可以選擇要將所安裝的package歸類到dependencies或者devDependencies</p>

<div class="highlighter-rouge"><pre class="highlight"><code>npm install {package-name} --save # dependencies
npm install {package-name} --save-dev # devDependencies
</code></pre>
</div>

<p>安裝後，我們可以很輕易的來使用這些packages，透過<strong>require</strong></p>

<div class="highlighter-rouge"><pre class="highlight"><code>var package = require('{package-name}')
</code></pre>
</div>

<p>在<em>package.json</em>中，有一個欄位是<strong>scripts</strong>，裡面代表我們能夠運行的腳本</p>

<div class="highlighter-rouge"><pre class="highlight"><code>npm run {script-name}
</code></pre>
</div>

<p>這裡是我目前某個專案的<em>package.json</em>檔節錄</p>

<div class="highlighter-rouge"><pre class="highlight"><code>"scripts": {
"start": "react-scripts start",
"build": "react-scripts build",
"test": "react-scripts test --env=jsdom",
"eject": "react-scripts eject"
}
</code></pre>
</div>

<p>所以，當我們運行</p>

<div class="highlighter-rouge"><pre class="highlight"><code>npm run build
</code></pre>
</div>

<p>實際上運行的是</p>

<div class="highlighter-rouge"><pre class="highlight"><code>npm run react-scrips build
</code></pre>
</div>

<p>此外，npm中每個腳本有兩個hooks，分別為pre-跟post-，在執行腳本時，會先檢查有沒有pre-，有的話會先跑pre-</p>

<p>一樣的，運行完也會檢查有沒有post-</p>

<p>舉例來說：當我們跑</p>

<div class="highlighter-rouge"><pre class="highlight"><code>npm run build
</code></pre>
</div>

<p>如果scripts中有「prebuild」，那就會先跑prebuild</p>

<hr />

<p>在npm中還有一個很有用的指令：<code class="highlighter-rouge">npm link</code></p>

<p>原本不能直接對global package使用require，但如果使用link指令將global package指到存放local package的位置後</p>

<p>就能夠打破此限制</p>

<div class="highlighter-rouge"><pre class="highlight"><code>npm link {package-name} {position of the local package} {position of the global package}
</code></pre>
</div>

<hr />
<h2 id="npm可能潛藏的問題">npm可能潛藏的問題</h2>
<hr />

<p>根據維基百科的內容：</p>

<div class="highlighter-rouge"><pre class="highlight"><code>npm的模組以「先到先得」的原則註冊，各模組作者不會發生混亂。然而一旦有人撤回自己釋出的模組，那麼不僅會使依賴那個模組的專案出現問題，還會帶來安全風險。例如有一個模組叫做「left-pad」，其中只有一個字串對齊的功能。但是，當作者把它從registry裡面移除之後，許多模組便無法正確構建
</code></pre>
</div>

<p>在npm中，我們建構package時，就像是堆積木一樣，大部分時候我們需要依賴別人已經做好的package，在這之上完成更大的package</p>

<p>但如果今天把積木底層的一塊抽開，整座積木就變得不穩定，甚至可能會倒塌</p>

<p>此外，由於大家都能夠簡單在npm上發布package，在npm上可能存在惡意的package，並且不被注意到廣泛地被使用到新的package中</p>

<p>就像病毒擴散一樣，更多的package又建構在受污染的package上，因而造成安全性問題</p>

<p>下面這篇文章的作者就說明了npm潛藏的問題，假設今天有一段盜用信用卡的程式碼偽裝成有用的小工具，並且利用npm平台擴散出去</p>

<p>便能夠藉此取得全球上千萬人的信用卡資料，有興趣的人可以參考<a href="https://medium.com/@CQD/翻譯-我是這樣拿走大家網站上的信用卡號跟密碼的-991cb6c4631e">這篇文章</a></p>

<hr />
<h2 id="來源references">來源(References)</h2>
<hr />

<p><em>wiki: https://zh.wikipedia.org/wiki/Npm</em>
<em>RUNOOB.COM: http://www.runoob.com/nodejs/nodejs-npm.html</em>
<em>Never_yu’s Blog: https://neveryu.github.io/2017/04/10/npm/</em>
<em>CQD&amp;hackermoon</em>: 
	- https://medium.com/@CQD/翻譯-我是這樣拿走大家網站上的信用卡號跟密碼的-991cb6c4631e
	- https://hackernoon.com/im-harvesting-credit-card-numbers-and-passwords-from-your-site-here-s-how-9a8cb347c5b5</p>

