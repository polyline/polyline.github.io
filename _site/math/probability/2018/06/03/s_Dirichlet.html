<!-- OK -->

<!DOCTYPE html>
<html>
	<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Chen Tse-Pei's Blog</title>

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
<!-- My CSS -->
<link href="/res/css/common.css" rel="stylesheet">

	</head>
	<body>		
				<!-- JQeury -->
    <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js" integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/js/bootstrap.min.js" integrity="sha384-h0AbiXch4ZDo7tp9hKZ4TsHbi047NrKGLO3SEJAg45jXxnGIfYzk4Si90RDIqNm1" crossorigin="anonymous"></script>
    
	<!-- Font Awesome -->
	<script defer src="https://use.fontawesome.com/releases/v5.0.13/js/all.js" integrity="	sha384-xymdQtn1n3lH2wcu0qhcdaOpQwyoarkgLVxC/wZ5q7h9gHtxICrpcaSUfygqZGOe" crossorigin="anonymous"></script>

	<!-- support MathJax -->
	<style TYPE="text/css">
	code.has-jax {font: inherit; font-size: 100%; background: inherit; border: inherit;}
	</style>
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	    tex2jax: {
	        inlineMath: [['$','$'], ['\\(','\\)']],
	        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'] // removed 'code' entry
	    }
	});
	MathJax.Hub.Queue(function() {
	    var all = MathJax.Hub.getAllJax(), i;
	    for(i = 0; i < all.length; i += 1) {
	        all[i].SourceElement().parentNode.className += ' has-jax';
	    }
	});
	</script>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

		<header>
			<!-- OK -->

<div class="container">
  <nav class="navbar navbar-expand-lg navbar-default nav-color" >
    <a class="navbar-brand" href="/index.html">Tsu-Pei Blog</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span><i class="fas fa-bars" ></i></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarSupportedContent">

        <ul class="navbar-nav ml-auto navbar-right">
          <li class="nav-item">
             <a class="nav-link" href="/index.html">About me</a>
          </li>
          <li class="nav-item">
             <a class="nav-link" href="/posts">Ariticles</a>
          </li
          <li class="nav-item">
             <a class="nav-link" href="/works">Works</a>
          </li>
        </ul>
    </div>
  </nav>
</div>

		</header>
		<main>
			<!-- OK -->

<div class="container-fluid text-center bg-color">
	<div class="">
	<div class="row bg-icon">
		<div class="col-md-2 col-sm-0">

		</div>
		<div class="view-home col-md-8 col-sm-12 home-color">
			<div class="article-window text-left">

<div class="article-title view-color">
	<h1>[讀]Dirichlet Distribution</h1>
</div>

<div>

	<a href="#" class="badge badge-success">math</a>

	<a href="#" class="badge badge-success">probability</a>


</div>

<div class="article-content view-color">
	<p><em>2018-6-3</em></p>

<hr />
<h2 id="前言">前言</h2>
<hr />

<p>LDA Topic Model中，用到了一些機率分布，像是<code class="highlighter-rouge">Multinomial Distribution</code>, <code class="highlighter-rouge">Beta Distribution</code>, <code class="highlighter-rouge">Dirichlet Distribution</code></p>

<p>不過對於這些分布並沒有一個完整的了解，我們參考<code class="highlighter-rouge">PRML</code>這本書並在這篇文章整理複習一下吧！</p>

<!--more-->

<hr />
<h2 id="distribution">Distribution</h2>
<hr />

<p>在進入到Dirichlet Distribution之前，我們先複習一下一些常見的Distribution</p>

<ol>
  <li>Bernoulli Distribution</li>
  <li>Binomial Distribution</li>
</ol>

<p><code class="highlighter-rouge">Bernoulli Distribution</code></p>

<p>假設我們擲一個硬幣一次，在擲出正面的機率為<script type="math/tex">\mu</script>的前提下，得到正面<script type="math/tex">x=1</script>的機率為</p>

<script type="math/tex; mode=display">Bern(x\mid \mu)=\mu^{x}(1-\mu)^{1-x}</script>

<p>當我們給定<script type="math/tex">\mu</script>時</p>

<script type="math/tex; mode=display">Bern(x=1\mid \mu) = \mu</script>

<script type="math/tex; mode=display">Bern(x=0\mid \mu) = 1-\mu</script>

<p><em>注意: Bernoulli只看一次的機率，而<script type="math/tex">x\in{0,1}</script></em></p>

<p><code class="highlighter-rouge">Binomial Distribution</code></p>

<p>如果我們進行<script type="math/tex">N</script>次的Bernoulli Distribution，就會得到Binomial Distribution</p>

<script type="math/tex; mode=display">Bin(m\mid N,\mu)=\binom{N}{m}\mu^{m}(1-\mu)^{N-m}</script>

<hr />
<h2 id="conjugacy">Conjugacy</h2>
<hr />

<p>關於共軛先驗、共軛分布的概念，這篇<a href="https://blog.csdn.net/baimafujinji/article/details/51374202">博客</a>寫的相當清楚，建議先進去看看，然後接著我會稍微整理我的理解</p>

<p>讓我們先看一下<code class="highlighter-rouge">Bayes' Theorem</code></p>

<script type="math/tex; mode=display">P(A\mid B) = \frac{P(B\mid A)P(A)}{P(B)}</script>

<p><script type="math/tex">P(A\mid B)</script>我們稱為後驗機率(posterior)，<script type="math/tex">P(A)</script>是先驗機率(prior)，<script type="math/tex">P(B\mid A)</script>是似然機率(likelihood)</p>

<p>先驗機率是我們基於對現實世界的認知，得到的機率</p>

<p>例如在一個裝有100顆相同大小的球的箱子，其中有60顆紅色球、40顆黃色球，球上面編號1到100，1到60為紅色，61到100為黃色</p>

<p>抽到紅色球的機率我們會認為是<script type="math/tex">0.6</script></p>

<p>而後驗機率則是，我們基於某證據B，得到的機率，假設$事件R表示抽到紅色球的事件，事件T代表抽到球編號大於50的事件$</p>

<p>今天我們抽到了一個編號大於50的事件，求是紅色球的機率為何</p>

<script type="math/tex; mode=display">P(R\mid T)=\frac{P(T\mid R)P(R)}{P(T)} = \frac{\frac{1}{6}\times 0.6}{0.5} = \frac{1}{5}</script>

<p>我們可以看到這個例子中，先驗機率為0.6而後驗機率為0.2，在我們得知某個條件或者證據之下，求出的機率即為後驗機率</p>

<p>在看一個例子我們會更了解，我們拿上面博客中拿來說明共軛分佈的硬幣例子</p>

<p>假設我們今天擲了一個硬幣五次，得到三次正面，兩次反面，稱這個結果為事件$T$，而我們已知直到硬幣正面的機率$\theta$只可能是<code class="highlighter-rouge">0.5</code>或者<code class="highlighter-rouge">0.8</code></p>

<p>而且$P(\theta = 0.5)=0.5, P(\theta = 0.8) = 0.5$</p>

<p>根據Bayes’ Theorem，我們寫出以下式子</p>

<script type="math/tex; mode=display">P(\theta=0.5 \mid T) = \frac{P(T \mid \theta=0.5) \times P(\theta =0.5)}{P(T)} = 0.30204</script>

<p>根據以上式子，本來硬幣擲到正面的機率是0.5的機率(也就是$P(\theta = 0.5)$)是0.5，但在有觀測結果$T$的前提下，$P(\theta = 0.5)$降低到0.30204</p>

<hr />

<p>而如果今天，<code class="highlighter-rouge">prior</code>不是一個機率，而是一個分布的話，就稱為<code class="highlighter-rouge">先驗分布</code></p>

<p>那這個<code class="highlighter-rouge">prior</code>要怎麼取呢？我們來看一下課本的解釋</p>

<blockquote>
  <p>If we choose a prior to be proportional to powers of μ and (1 − μ), then the posterior distribution, which is proportional to the product of the prior and the likelihood function, will have the same functional form as the prior. This property is called conjugacy</p>
</blockquote>

<p>我們取跟<code class="highlighter-rouge">likelihood function</code>指數成正比的<code class="highlighter-rouge">prior</code>，今天要討論的<code class="highlighter-rouge">Beta分布</code>，其實就是<code class="highlighter-rouge">Binominal分布</code>的<code class="highlighter-rouge">共軛分布</code></p>

<p>以剛剛的擲硬幣例子來說，如果我們改成用Beta分布來表示硬幣擲到正面的機率，而後驗分布也會是一個Beta分布(證明請看上面參考博客)</p>

<script type="math/tex; mode=display">P(\theta \mid X) = Beta(\theta \mid a+3, b+2)</script>

<p>我理解共軛性(conjugacy)的重要性是，我們可以經由觀測數據來修正原本的<code class="highlighter-rouge">先驗分布</code></p>

<p>假設一開始Beta分布的高峰值在0.8，但經過我們的觀測後，修正了原本的Beta分布高峰值在0.7</p>

<p>回到課本中，我們現在知道了，我可以經由<code class="highlighter-rouge">Binominal distribution</code>跟先驗分布的<code class="highlighter-rouge">Beta Distribution</code>相乘而得到後驗分布</p>

<script type="math/tex; mode=display">P(μ\mid m, l, a, b) \propto μ^{m+a−1}(1 − μ)^{l+b−1}, m為正面次數, l為反面次數, a和b為prior的係數</script>

<hr />
<h2 id="multinomial-distribution-and-dirichlet-distribution">Multinomial distribution and Dirichlet distribution</h2>
<hr />

<p>我們直接來看Multinomial distribution的公式</p>

<script type="math/tex; mode=display">Mult(m_{1},m_{2},...,m_{K} \mid \mu ,N) = \binom{N}{m_{1} m_{2} ... m_{k}} \prod_{k=1}^{K} u_{k}^{m_{k}}</script>

<p>其中$K$表示所有可能的$state$，在<code class="highlighter-rouge">Binomial Distribution</code>只有兩種可能，但在這邊有$ K $種$ state $</p>

<p>我們用$ m_{k} $表示該$ state $下的出現次數，$ \mu_{k} $則是該$state$的機率，另外所有$m_{k} $的總和即為$ N $</p>

<script type="math/tex; mode=display">\sum_{k=1}^{K} m_{k} = N</script>

<p>而<code class="highlighter-rouge">Dirichlet Distribution</code>就只是<code class="highlighter-rouge">Multinomial Distribution</code>的先驗分布<code class="highlighter-rouge">prior</code></p>

<p>所以我們要取跟上面的<code class="highlighter-rouge">Multinomial Distribution</code>相同形式的函式，並且用$\alpha $當作參數控制</p>

<script type="math/tex; mode=display">p(\mu \mid \alpha) \propto \prod_{k=1}^{K} \mu_{k}^{\alpha_{k-1}}</script>

<p>經過normalize之後，我們得到</p>

<script type="math/tex; mode=display">Dir(\mu \mid \alpha) = \frac{\Gamma(\alpha_{0})}{\Gamma(\alpha_{1})...\Gamma(\alpha_{K})} \prod_{k=1}^{K} \mu_{k}^{\alpha_{k}-1}</script>

<script type="math/tex; mode=display">while \space \alpha_{0} = \sum_{k=1}^{K} \alpha^{k}</script>

<p>再來，我們只要把<code class="highlighter-rouge">Likelihood Function</code>跟<code class="highlighter-rouge">Prior Function</code>相乘後，就能得到我們的<code class="highlighter-rouge">posterior</code>，而posterior也會是<code class="highlighter-rouge">Dirichlet Function</code></p>

<p>只是參數有變化</p>

<script type="math/tex; mode=display">p(\mu \mid D, \alpha) = Dir(\mu \mid \alpha + m) = \frac{\Gamma(\alpha_{0}+N)}{\Gamma(\alpha_{1}+m_{0})...\Gamma(\alpha_{K}+m_{k})} \prod_{k=1}^{K} \mu_{k}^{\alpha_{k}+m_{k}-1}</script>

<p>所以，<code class="highlighter-rouge">Dirichlet Distribution</code>的參數從原來的$\alpha$變成了$\alpha + m$，$m$是觀察到各個$state$的次數</p>

<hr />
<h2 id="reference">Reference</h2>
<hr />

<ol>
  <li>PRML</li>
  <li><a href="https://blog.csdn.net/baimafujinji/article/details/51374202">博客</a></li>
</ol>

<p><em>2018/6/4</em></p>


</div>

</div>
		</div>
		<div>
		</div>
	</div>
	<div>
</div>
		</main>
		<footer class="footer">
			<!-- No -->

<!--This is the footer of the website-->

<div class="footer-window container-fluid footer-color">
	<div class="row">
		<div class="footer-view footer-info col-md-4 text-left">
				<div class="text-left">
					<i class="fab fa-github-square fa-3x"></i> 
					<span class="account">@polyline</span>
				</div>
				<div>
					<i class="fab fa-instagram fa-3x"></i> 
					<span class="account">@__tsu__pei</span>
				</div>
				<div>
					<i class="fas fa-envelope fa-3x" ></i> 
					<span class="account">a5560648@gmail.com</span>
				</div>
		</div>
		<div class="footer-view footer-words col-md-4">
			<p>快樂有很多種</p>
			<p>平凡的快樂、頹廢的快樂、成就的快樂</p>
			<p>追尋自己想要的快樂</p>
		</div>
		<div class="footer-view footer-license col-md-4 text-center">
			<p>Version 0.0.5</p>
		</div>
	</div>
</div>

<!--
log
<p>Version 0.0.2</p>
			<p>0.0.2 - 配色完成</p>
			<p>0.0.2 - 基本模板完成</p>
			<p>0.0.2 - 自我介紹新增打字效果</p>




-->
		</footer>
		</div>
	</body>
</html>

<script>
$(".badge-info").hover(function(){
    $(this).hide(1000);
});


</script>